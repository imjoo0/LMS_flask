{% extends 'index.html' %}
{% block title %}
관리부서 페이지
{% endblock %}

{% block topnav %}
{% if user %}
관리부서님 환영합니다.
{% else %}
로그인이 필요합니다.
{% endif %}
{% endblock %}
{% block style %}
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="../static/style/manage.css">
<link rel="stylesheet" href="../static/style/paginate.css">
<link rel="stylesheet" href="../static/style/teacher.css">
{% endblock %}
{% block content %}
{% autoescape off %}
<script type="text/javascript">
    var csrf_token = "{{ csrf_token() }}";
    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrf_token);
            }
        }
    });
</script>

<!-- 신규 상담 요청 모달 -->
<div class="modal fade" id="request_consulting" tabindex="-1" aria-labelledby="RequestConsultingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-handling">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="RequestConsultingModalLabel">
                    상담 요청
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <input id="csrf_token" type="hidden" name="csrf_token" value="{{ csrf_token() }}" style="display: block;" />
                <div class="d-flex justify-content-center align-items-center flex-column">
                    <div class="row w-100 mt-3">
                        <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 상담 카테고리 선택</span></div>
                        <div class="col-sm-9">
                            <select class="form-control form-control-sm" id="consulting_category_list">
                            </select>
                        </div>
                    </div>
                    <div class="row w-100 mt-3">
                        <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 상담 내용 입력</span></div>
                        <div class="col-sm-9">
                            <input class="form-control form-control-sm" type="text" id="consulting_contents" placeholder="상담 내용을 입력해주세요">
                        </div>
                    </div>
                    <div class="row w-100 mt-3">
                        <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 상담 시작일</span></div>
                        <div class="col-sm-3">
                            <input type="text" id="consulting_date" placeholder="상담 시작일 선택">
                        </div>
                        <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 상담 마감일</span></div>
                        <div class="col-sm-3">
                            <input type="text" id="consulting_deadline" placeholder="상담 마감일 선택">
                        </div>
                    </div>
                </div>
                <div class="notice_message mt-4">
                    <p class="mb-2" style="padding: 0 12px">👇 상담을 진행할 반을 선택해주세요</p>
                    <div class="plus_under_contents" style="padding: 0 12px;">
                        <select class="border rounded-0 form-control form-control-sm" onchange="ban_change(this.value)" multiple id="consulting_target_aban">
                            <optgroup label="전체 반 선택">
                                <option value=0>전체 반 대상 진행</option>
                                <option value=1>PLUS/ALPHA반 대상 진행</option>
                                <option value=2>NF/NOVEL반 대상 진행</option>
                            </optgroup>
                            <optgroup id="consulting_target_ban" label="개별 반 선택" multiple>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="notice_message mt-4" id="select_student">
                    <p class="mb-2" style="padding: 0 12px;">👇 상담을 진행할 학생을 선택해주세요</p>
                    <div class="plus_under_contents" style="padding: 0 12px;">
                        <select class="border rounded-0 form-control form-control-sm" id="consulting_target_students" multiple>

                        </select>
                    </div>
                </div>
                <div class="notice_message">
                    <table class="table text-center" >
                        <tbody style="width:100%;">
                            <tr class="row">
                                <th class="col-12" id="consulting_msg"></th>
                            </tr>
                            <tr class="row" id="result_tbox">
                                
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" onclick="post_consulting_request()">저장</button>
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">취소</button>
            </div>
        </div>
    </div>
</div>

<!-- 요청한 상담 관리 모달 창 -->
<div class="modal fade" id="my_consulting_request" tabindex="-1" aria-labelledby="my_consulting_requestModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-handling">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="my_consulting_requestModalLabel">
                    요청한 상담 목록
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="my-4 d-flex flex-wrap justify-content-end align-items-center">
                    <div class="col-lg-2 col-md-3 col-sm-4 col-12 pb-3 pb-sm-0"><span>📌 상담 카테고리 선택</span></div>
                    <div class="col-md-4 col-sm-6 col-12">
                        <select id="category-select" onchange="sort_consulting(this.value)" class="form-select form-select-sm w-100" aria-label="Default select example">
                            <optgroup id="consulting-option">
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="d-flex justify-content-start align-items-start flex-column" style="overflow: auto;">
                    <table class="table text-center" id="consulting_task_list">
                        <thead>
                            <tr class="row">
                                <th class="col-3">날짜</th>
                                <th class="col-2">종류</th>
                                <th class="col-1">진행</th>
                                <th class="col-4">내용</th>
                                <th class="col-2">수정/삭제</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="row" id="tr-row">
                                <td>
                                    <div class="loader loader--style2" title="1">
                                            <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
                                            <path fill="#000" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z">
                                                <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"/>
                                            </path>
                                        </svg>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="d-flex justify-content-center align-items-center w-100">
                    <div id="consulting-pagination" class="mt-4 mb-5 text-center"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 상담 일지 조회 모달-->
<div class="modal fade" id="consultinghistory" tabindex="-1" aria-labelledby="consultinghistoryModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="consultinghistoryModalLabelt">
                    <img src="#" style="width: 30px;">&nbsp;&nbsp;상담일지 작성
                </h5>
                <button type="button" class="btn btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body py-4 px-5">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" style="display: block;" />
                <div class="d-flex justify-content-center mt-4 mb-2">
                    <div id="consulting_write_box">

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 신규 업무 요청 모달 -->
<div class="modal fade" id="request_task" tabindex="-1" aria-labelledby="RequestTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="RequestTaskModalLabel">
                    업무 요청
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form action="/manage/task" method="POST">
                <div class="modal-body">
                    <input id="csrf_token" type="hidden" name="csrf_token" value="{{ csrf_token() }}"
                        style="display: block;" />
                    <div class="d-flex justify-content-center align-items-center flex-column">
                        <div class="row w-100 mt-3">
                            <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 업무 카테고리 </span></div>
                            <div class="col-sm-9">
                                <select class="form-control form-control-sm" name="task_category" id="task_category_list">
                                </select>
                            </div>
                        </div>
                        <div class="row w-100 mt-3">
                            <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 업무 내용 </span></div>
                            <div class="col-sm-9">
                                <input class="form-control form-control-sm" type="text" name="task_contents" placeholder="업무 내용을 입력해주세요">
                            </div>
                        </div>
                        <div class="row w-100 mt-3">
                            <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 업무 주기 </span></div>
                            <div class="col-sm-9">
                                <select class="border rounded-0 form-control form-control-sm" name="task_cycle">
                                    <optgroup>
                                        <option value="none" selected>업무 주기를 선택해주세요</option>
                                        <option value=0>업무 주기 없음</option>
                                        <option value=1>월요일 업무</option>
                                        <option value=2>화요일 업무</option>
                                        <option value=3>수요일 업무</option>
                                        <option value=4>목요일 업무</option>
                                        <option value=5>금요일 업무</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>
                        <div class="row w-100 mt-3">
                            <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 업무 순서</span></div>
                            <div class="col-sm-9">
                                <select class="border rounded-0 form-control form-control-sm" name="task_priority">
                                    <optgroup>
                                        <option value="none" selected>업무 순서를 선택해주세요</option>
                                        <option value=1>순서 무관</option>
                                        <option value=2>오후 업무</option>
                                        <option value=3>오전 업무 🌞</option>
                                        <option value=4>긴급 업무 ⚡</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>
                        <div class="row w-100 mt-3">
                            <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 업무 시작일</span></div>
                            <div class="col-sm-3">
                                <input type="text" name="task_date" id="task_date" placeholder="업무 시작일 선택">
                            </div>
                            <div class="col-sm-3 mb-sm-0 mb-2"><span>📌 업무 마감일</span></div>
                            <div class="col-sm-3">
                                <input type="text"  name="task_deadline" id="task_deadline" placeholder="업무 마감일 선택">
                            </div>
                        </div>
                    </div>
                    <div class="notice_message mt-4">
                        <p class="mb-2" style="padding: 0 12px">👇 업무를 진행할 반을 선택해주세요</p>
                        <div class="plus_under_contents" style="padding: 0 12px;">
                            <select class="border rounded-0 form-control form-control-sm" onchange="task_ban_change(this.value)" multiple name="task_target_ban[]">
                                <optgroup label="전체 반 선택">
                                    <option value=0>전체 반 대상 진행</option>
                                    <option value=1>PLUS/ALPHA반 대상 진행</option>
                                    <option value=2>NF/NOVEL반 대상 진행</option>
                                </optgroup>
                                <optgroup id="task_target_ban" label="개별 반 선택" multiple>
                                </optgroup>
                            </select>
                            <table class="table text-center mt-4">
                                <tbody style="width:100%;">
                                    <tr class="row">
                                        <th class="col-12" id="task_msg"></th>
                                    </tr>
                                    <tr class="row" id="target_task_bans">
                                        
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- <div class="notice_message">
                        <p class="mb-2" style="padding: 0 12px;">👇 업무을 시작해야 하는 날짜를 2022-01-01 형식으로 적어주세요</p>
                        <div style="padding: 0 12px;">
                            <input class="border rounded-0 form-control form-control-sm" type="text" name="task_date" placeholder="2023-01-01">
                        </div>
                    </div>

                    <div class="notice_message mt-4">
                        <p class="mb-2" style="padding: 0 12px;">👇 업무을 끝내야 하는 마감 날짜를 2022-01-01 형식으로 적어주세요</p>
                        <div style="padding: 0 12px;">
                            <input class="border rounded-0 form-control form-control-sm" type="text" name="task_deadline" placeholder="2023-01-01">
                        </div>
                    </div>
                    
                    <div class="notice_message mt-4">
                        <p class="mb-2" style="padding: 0 12px;">👇 업무 참고 url 을 알려주세요 (없을 경우: 없음)</p>
                        <div style="padding: 0 12px;">
                            <input class="border rounded-0 form-control form-control-sm" type="text" name="task_url" placeholder="https://www.purpleacademy.co.kr/">
                        </div>
                    </div> -->

                    <div class="d-flex justify-content-center align-items-center flex-column mt-3">
                        
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-success" type="submit">저장</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">취소</button>
                </div>

                    <!-- <div class="notice_message">
                        <p>👇 업무를 진행할 반을 선택해주세요</p>
                        <div class="plus_under_contents">
                            <select class="border rounded-0 form-control form-control-sm" onchange="task_ban_change(this.value)" multiple name="task_target_ban[]">
                                <optgroup label="전체 반 선택">
                                    <option value=0>전체 반 대상 진행</option>
                                    <option value=1>PLUS/ALPHA반 대상 진행</option>
                                    <option value=2>NF/NOVEL반 대상 진행</option>
                                </optgroup>
                                <optgroup id="task_target_ban" label="개별 반 선택" multiple>
                                </optgroup>
                            </select>
                            <table class="table text-center" >
                                <tbody style="width:100%;">
                                    <tr class="row">
                                        <th class="col-12" id="task_msg"></th>
                                    </tr>
                                    <tr class="row" id="target_task_bans">
                                        
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="notice_message">
                        <p>👇 업무을 시작해야 하는 날짜를 2022-01-01 형식으로 적어주세요</p>
                        <input class="border rounded-0 form-control form-control-sm" type="text" name="task_date"
                            placeholder="2023-01-01">
                    </div>

                    <div class="notice_message">
                        <p>👇 업무을 끝내야 하는 마감 날짜를 2022-01-01 형식으로 적어주세요</p>
                        <input class="border rounded-0 form-control form-control-sm" type="text" name="task_deadline"
                            placeholder="2023-01-01">
                    </div>
                    <div class="notice_message">
                        <p>👇 업무 참고 url 을 알려주세요 (없을 경우: 없음)</p>
                        <input class="border rounded-0 form-control form-control-sm" type="text" name="task_url"
                            placeholder="https://www.purpleacademy.co.kr/">
                    </div>
                    <div class="notice_message">
                        <p style="margin-right: 6px;"> 업무 주기와 업무 우선순위설정 : </p>
                        <div class="make_row">
                            <select class="border rounded-0 form-control form-control-sm" name="task_cycle"
                                style=" width: 200px; height: 100%; margin-left:0;">
                                <optgroup>
                                    <option value="none" selected>업무 주기를 선택해주세요</option>
                                    <option value=0>업무 주기 없음</option>
                                    <option value=1>월요일 업무</option>
                                    <option value=2>화요일 업무</option>
                                    <option value=3>수요일 업무</option>
                                    <option value=4>목요일 업무</option>
                                    <option value=5>금요일 업무</option>
                                </optgroup>
                            </select>
                            <select class="border rounded-0 form-control form-control-sm" name="task_priority"
                                style=" width: 200px; height: 100%; margin-left:0;">
                                <optgroup>
                                    <option value="none" selected>업무 우선순위를 선택해주세요</option>
                                    <option value=1>우선순위 무관</option>
                                    <option value=2>오후 업무</option>
                                    <option value=3>오전 업무</option>
                                    <option value=4>최우선 업무</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; float: right;">
                        <button class="btn btn-success" type="submit" style="margin-top: 13px;">저장</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal"
                            style="margin-top: 13px;">취소</button>
                    </div> -->            
            </form>
        </div>
    </div>
</div>

<!-- 요청한 업무 관리 모달 창 -->
<div class="modal fade" id="my_task_request" tabindex="-1" aria-labelledby="taskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="taskModalLabel">
                    요청 중인 업무 목록
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="for_task_list">
                    <div class="my-4 d-flex flex-wrap justify-content-end align-items-center">
                        <div class="col-lg-2 col-md-3 col-sm-4 col-12 pb-3 pb-sm-0"><span>📌 업무 카테고리 선택</span></div>
                        <div class="col-md-4 col-sm-6 col-12">
                            <select id="task-category-select" onchange="sort_task(this.value)" class="form-select form-select w-100" aria-label="Default select example">
                                <optgroup id="task-option">
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    <div class="d-flex justify-content-start align-items-start flex-column" style="overflow: auto;">
                        <table class="table text-center" id="consulting_task_list">
                            <thead>
                                <tr class="row">
                                    <th class="col-3">날짜</th>
                                    <th class="col-3">종류</th>
                                    <th class="col-4">내용</th>
                                    <th class="col-2">상세/삭제</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="row" id="task-tr">
                                    <td>
                                        <div class="loader loader--style2" title="1">
                                            <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
                                                <path fill="#000" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z">
                                                    <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"/>
                                                </path>
                                            </svg>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="d-flex justify-content-center align-items-center w-100">
                        <div id="task-pagination" class="py-5"></div>
                    </div>
                </div>

                <div id="for_taskban_list">
                    <button type="button" class="btn btn-back" onclick="go_back()">업무 목록보기🔙 </button>
                    <table class="table text-center" style="width:100%;">
                        <tbody style="width:100%;">
                            <thead>
                                <tr class="row">
                                    <th class="col-4">반</th>
                                    <th class="col-4">진행</th>
                                    <th class="col-4">삭제</th>
                                </tr>
                            </thead>
                            <tr class="row" id="taskban_list">
                                <td class="col-4">ddd</td>
                                <td class="col-4">ddd</td>
                                <td class="col-4">✖️</td>
                            </tr>
                        </tbody>
                    </table>
                </div>            
            </div>
    
            <!-- <div id="for_task_list">
                <div class="modal-header">
                    <select id="task-category-select" onchange="sort_task(this.value)" class="form-select"
                        aria-label="Default select example">
                        <optgroup id="task-option">
                        </optgroup>
                    </select>
                </div>
                <div>
                    <table class="table text-center" id="task_list" style="width:100%;">
                        <tbody style="width:100%;">
                            <thead>
                                <tr class="row">
                                    <th class="col-3">날짜</th>
                                    <th class="col-3">종류</th>
                                    <th class="col-4">내용</th>
                                    <th class="col-2">상세|삭제</th>
                                </tr>
                            </thead>
                            <tr id="task-tr" class="row"></tr>
                        </tbody>
                    </table>
                    <div id="task-pagination" class="py-5"></div>
                </div>
            </div>
            <div id="for_taskban_list">
                <button type="button" class="btn btn-back" onclick="go_back()">업무 목록보기🔙 </button>
                <table class="table text-center" style="width:100%;">
                    <tbody style="width:100%;">
                        <thead>
                            <tr class="row">
                                <th class="col-4">반</th>
                                <th class="col-4">진행</th>
                                <th class="col-4">삭제</th>
                            </tr>
                        </thead>
                        <tr class="row" id="taskban_list">
                            <td class="col-4">ddd</td>
                            <td class="col-4">ddd</td>
                            <td class="col-4">✖️</td>
                        </tr>
                    </tbody>
                </table>
            </div> -->
        </div>
    </div>
</div>

<!-- PURPLE 섹션 -->
<!-- 반 정보 상세 조회 모달 창 -->
<div class="modal fade" id="target_ban_info" tabindex="-1" aria-labelledby="target_ban_info_requestModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-handling">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="target_ban_info_requestModalLabel">
                    반 상세 현황
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="inloading" class="loader loader--style2 text-center" title="1">
                    <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
                        <path fill="#000" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z">
                            <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"/>
                        </path>
                    </svg>
                </div>
                <!-- <h1 id="inloading" style="display: none;">로딩중..</h1> -->
                <div id="target_ban_info_body">
                    <div class="my-4 d-flex flex-wrap justify-content-end align-items-center">
                        <div class="col-lg-2 col-md-3 col-sm-4 col-12 pb-3 pb-sm-0"><span>📌 상세조회 할 반 선택</span></div>
                        <div class="col-md-4 col-sm-6 col-12">
                            <select id="category-select" onchange="getBanChart(this.value)" class="form-select form-select-sm"
                                aria-label="Default select example">
                                <optgroup id="ban_list">
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    <div class="d-flex justify-content-start align-items-start flex-column" style="overflow: auto;">
                        <table class="table text-center" id="profile_data" >
                        </table>
                        <table class="table text-center" id="ban_data" >
                        </table>
    
                        <table class="table text-center" id="student_data">
                            <tr class="row" style="background: #DCE6F2;">
                                <th class="col-12" id="displayCount"></th>
                            </tr>
                            <tr class="row" style="background:#DCE6F2;">
                                <th class="col-2">원생 정보</th>
                                <th class="col-2">연락처</th>
                                <th class="col-3">부모님 정보</th>
                                <th class="col-2">추천도서</th>
                                <th class="col-2">미학습</th>
                                <th class="col-1">상세</th>
                            </tr>
                            <tr id="s_data" class="row"></tr>
                        </table>
                        <ul id="pagingul"></ul>
                        <div id="ban_statistics" class="make_row w-100"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- 이반/퇴소 문의 조회 모달 -->
<div class="modal fade" id="soanswer" tabindex="-1" aria-labelledby="answerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="answerModalLabel">
                    선생님 문의
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <table class="table text-center" style="width:100%;" id="consulting_history_attach">
                    <tbody style="width:100%;">
                        <thead>
                            <tr class="row">
                                <th class="col-12">진행한 상담 내용</th>
                            </tr>
                        </thead>
                        <tr class="row">
                            <td class="col-12">
                                <div id="cha"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table text-center" style="width:100%;">
                    <tbody style="width:100%;">
                        <thead>
                            <tr class="row">
                                <th class="col-6">문의 내용</th>
                                <th class="col-6">답변 내용</th>
                            </tr>
                        </thead>
                        <tr class="row">
                            <td class="col-6">
                                <div id="teacher_question"></div>
                            </td>
                            <td class="col-6">
                                <div id="teacher_answer"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="manage_answer_1">
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">답변 제목</span>
                        <input class="modal-body-select" type="text" size="50" id="answer_title" style="width: 75%;">
                    </div>
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">답변 내용</span>
                        <textarea id="answer_contents" class="modal-body-select" type="text" rows="5" cols="25"
                            name="answer_contents1" style="width: 75%;"></textarea>
                    </div>
                </div>
                <div id="manage_answer_2">
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">이반 요청 결과</span>
                        <select class="modal-body-select" id="o_ban_id2">
                            <option value="none" selected>이반 처리 결과를 선택해주세요</option>
                            <option value=0>반려</option>
                            {% for ban in all_ban %}
                            {% set ban_registerno = ban['register_no'] %}
                            <option value={{ban_registerno}}>{{ ban['name'] }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div id="manage_answer_3">
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">요청 처리 결과</span>
                        <select class="modal-body-select" id="o_ban_id3">
                            <option value="none" selected>처리 결과를 선택해주세요</option>
                            <option value=0>반려</option>
                            <option value=1>승인</option>
                        </select>
                    </div>
                </div>
                <div id="comment_box">
                    <div class="notice_message">
                        <p>👇Comment </p>
                        <div class="make_row" id="comment_post_box">

                        </div>
                        <div id="comments" class="make_col" style="margin-top:20px">

                        </div>
                    </div>
                </div>
                <div id="fileforbox"></div>
                <div class="d-flex justify-content-center mt-4 mb-2" id="button_box">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 문의 조회 모달 창 -->
<div class="modal fade" id="answer" tabindex="-1" aria-labelledby="answerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="answerModalLabel">
                    선생님 문의
                </h5>
                <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <table class="table text-center" style="width:100%;" id="consulting_history_attach">
                    <tbody style="width:100%;">
                        <thead>
                            <tr class="row">
                                <th class="col-12">진행한 상담 내용</th>
                            </tr>
                        </thead>
                        <tr class="row">
                            <td class="col-12">
                                <div id="cha"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table text-center" style="width:100%;">
                    <tbody style="width:100%;">
                        <thead>
                            <tr class="row">
                                <th class="col-6">문의 내용</th>
                                <th class="col-6">답변 내용</th>
                            </tr>
                        </thead>
                        <tr class="row">
                            <td class="col-6">
                                <div id="teacher_question"></div>
                            </td>
                            <td class="col-6">
                                <div id="teacher_answer"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="manage_answer_1">
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">답변 제목</span>
                        <input class="modal-body-select" type="text" size="50" id="answer_title" style="width: 75%;">
                    </div>
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">답변 내용</span>
                        <textarea id="answer_contents" class="modal-body-select" type="text" rows="5" cols="25"
                            name="answer_contents1" style="width: 75%;"></textarea>
                    </div>
                </div>
                <div id="manage_answer_2">
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">이반 요청 결과</span>
                        <select class="modal-body-select" id="o_ban_id2">
                            <option value="none" selected>이반 처리 결과를 선택해주세요</option>
                            <option value=0>반려</option>
                            {% for ban in all_ban %}
                            {% set ban_registerno = ban['register_no'] %}
                            <option value={{ban_registerno}}>{{ ban['name'] }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div id="manage_answer_3">
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">요청 처리 결과</span>
                        <select class="modal-body-select" id="o_ban_id3">
                            <option value="none" selected>처리 결과를 선택해주세요</option>
                            <option value=0>반려</option>
                            <option value=1>승인</option>
                        </select>
                    </div>
                </div>
                <div id="comment_box">
                    <div class="notice_message">
                        <p>👇Comment </p>
                        <div class="make_row" id="comment_post_box">

                        </div>
                        <div id="comments" class="make_col" style="margin-top:20px">

                        </div>
                    </div>
                </div>
                <div id="fileforbox"></div>
                <div class="d-flex justify-content-center mt-4 mb-2" id="button_box">
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container_box">
    <div id="user-info" class="border-bottom">
        <div class="d-flex justify-content-center flex-xl-row row-cols-xl-2 flex-column-reverse">
            <!-- 왼쪽 버튼 4개 -->
            <div class="d-flex justify-content-center flex-row flex-wrap pb-xl-5 pe-xl-3 pb-5">
                <!-- <button onclick="edit_personal_info()">정보 수정</button> -->
                <div class="manage-work-btn" style="margin: 0 2% 2% 0;" data-bs-toggle="modal" data-bs-target="#request_consulting" onclick="request_consulting()">
                    <div class="manage-work-img">
                        <img src="../static/style/images/user.png">
                    </div>
                    <div class="manage-work-label-wrapper">
                        <span class="manage-work-label col-7">신규 상담 요청</span>
                    </div>
                </div>
                <div class="manage-work-btn" style="margin: 0 0 2% 0;" data-bs-toggle="modal" data-bs-target="#my_consulting_request" onclick="get_consulting()">
                    <div class="manage-work-img">
                        <img src="../static/style/images/conversation.png">
                    </div>
                    <div class="manage-work-label-wrapper">
                        <span class="manage-work-label">요청한 상담 관리</span>
                    </div>
                </div>
                <div class="manage-work-btn" style="margin: 0 2% 0 0;" data-bs-toggle="modal" data-bs-target="#request_task" onclick="request_task()">
                    <div class="manage-work-img">
                        <img src="../static/style/images/note.png">
                    </div>
                    <div class="manage-work-label-wrapper">
                        <span class="manage-work-label">신규 업무 요청</span>
                    </div>
                </div>
                <div class="manage-work-btn" data-bs-toggle="modal" data-bs-target="#my_task_request" onclick="get_task()">
                    <div class="manage-work-img">
                        <img src="../static/style/images/order.png">
                    </div>
                    <div class="manage-work-label-wrapper">
                        <span class="manage-work-label">요청한 업무 관리</span>
                    </div>
                </div>
            </div>

            <!-- 오른쪽 계정 정보 -->
            <div class="d-flex justify-content-start align-items-center pb-xl-5 ps-xl-3 pb-3">
                <div class="user-detail">
                    <div class="manage-user-detail-deco"></div>
                    <div class="user-name">
                        <img src="https://purpleacademy.net/free_project/public/image/teacher-profile.png">
                        <div class="d-flex justify-content-center align-items-center flex-column">
                            <span>PURPLE님 안녕하세요</span>
                            <div class="mt-2">
                                <a href="#" class="me-1" data-bs-toggle="modal" data-bs-target="#sign-out">
                                    <i class="fas fa-sign-out-alt text-danger fa-lg fs-6"></i>
                                </a>
                                <a href="#" class="ms-1" data-bs-toggle="modal" data-bs-target="#">
                                    <i class="fa-solid fa-gear text-primary fa-lg fs-6"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="user-contact">
                        <div class="mt-2">
                            <i class="fa-regular fa-envelope"></i>
                            <span>&nbsp;&nbsp;{{ user['email'] }}</span>
                        </div>
                        <div class="mt-3">
                            <i class="fa-solid fa-briefcase"></i>
                            <span>&nbsp;&nbsp;관리부서</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mb-5" style="border-bottom: 2px solid #2b2b2b11;"></div>

    <nav class="navbar navbar-expand mb-3" style="background-color: #f1f1f1; border-radius: 14px; border-bottom: 3px solid #F66F5B;">
        <div class="container-fluid">
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ps-sm-2 ps-lg-4 p-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" onclick="getBanlist()">PURPLE</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="sodata()">이반 퇴소 관리</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="uldata()">학습 관리</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="paginating(0)">CS 관리</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- 전체 반 조회 -->
    <div class="info-container" id="detailban" style="display: none;">
        <div class="info-title" style="border-bottom: 2px groove #F66F5B">
            <span id="banchart_title">PURPLE</span>
        </div>
        <div class="info  make_col">
            <div class="d-flex justify-content-center align-items-center flex-column w-100 make_row">
                <div id="ban-statistics" class="d-flex justify-content-end align-items-center w-100">
                    <div class="info-container" style="width:100%;">
                        <div class="row row-cols-2">
                            <div class="semester-student-chart-wrapper col-7 px-4 py-5">
                                <canvas id="semester-student-chart"></canvas>
                            </div>  
                           <div id="semester-student-table" class="col-5 px-4 py-5">
    
                            </div>
                        </div>
                        <table id="semester1" class="table text-center mt-5" style="width:100%;">
                            <thead>
                                <tr class="row">
                                    <th class="col-3">1월 학기</th>
                                    <th class="col-3">초기 등록 학생 수</th>
                                    <th class="col-3">관리중인 학생 수</th>
                                    <th class="col-2">퇴소 수</th>
                                    <th class="col-1">상세</th>
                                </tr>
                            </thead>
                            <tr class="row" id="semester_banlist1">

                            </tr>
                        </table>
                        <table id="semester5" class="table text-center mt-5" style="width:100%;">
                            <thead>
                                <tr class="row">
                                    <th class="col-3">5월 학기</th>
                                    <th class="col-3">초기 등록 학생 수</th>
                                    <th class="col-3">관리중인 학생 수</th>
                                    <th class="col-2">퇴소 수</th>
                                    <th class="col-1">상세</th>
                                </tr>
                            </thead>
                            <tr class="row" id="semester_banlist2">

                            </tr>
                        </table>
                        <table id="semester9" class="table text-center mt-5" style="width:100%;">
                            <thead>
                                <tr class="row">
                                    <th class="col-3">9월 학기</th>
                                    <th class="col-3">초기 등록 학생 수</th>
                                    <th class="col-3">관리중인 학생 수</th>
                                    <th class="col-2">퇴소 수</th>
                                    <th class="col-1">상세</th>
                                </tr>
                            </thead>
                            <tr class="row" id="semester_banlist0">

                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <!-- <div class="d-flex justify-content-center align-items-center flex-column w-100">
                <div class="d-flex justify-content-end align-items-center w-100">
                    <select class="manage-ban-select px-1 py-2 w-lg-50 w-100" name="target_ban"
                        onchange="getBanChart(this.value)" id="ban_list">
                    </select>
                </div>

                <div class="justify-content-start align-items-start w-100" style="overflow: scroll;">
                    <h1 id="inloading" style="display: none;">로딩중..</h1>
                    <table class="table text-center" id="profile_data" >
                    </table>
                    <table class="table text-center" id="ban_data" >
                    </table>

                    <table class="table text-center" id="student_data">
                        <tr class="row" style="background: #DCE6F2;">
                            <th class="col-12" id="displayCount"></th>
                        </tr>
                        <tr class="row" style="background:#DCE6F2;">
                            <th class="col-2">원생 정보</th>
                            <th class="col-2">연락처</th>
                            <th class="col-3">부모님 정보</th>
                            <th class="col-2">추천도서</th>
                            <th class="col-2">미학습</th>
                            <th class="col-1">상세</th>
                        </tr>
                        <tr id="s_data" class="row"></tr>
                    </table>
                    <ul id="pagingul"></ul>
                    <div id="ban_statistics" class="make_row w-100"></div>
                </div>
            </div> -->
        </div>
    </div>
    <!-- 이반 퇴소 관리 -->
    <div id="sobox" style="display: none;">
        <div class="info-container">
            <div class="info-title">
                <span>이반 / 퇴소 문의 관리</span>
            </div>
            <div class="info">
                <div class="d-flex justify-content-center align-items-center flex-column w-100">
                    <div class="d-flex justify-content-start align-items-start w-100" style="overflow: scroll;">
                        <div class="d-flex justify-content-start align-items-start w-100 make_col"
                            style="width: 1362px important;">
                            <h3 id="sotitle"></h3>
                            <table class="table text-center" style="width:100%;" id="sotable">
                                <tr class="row" style="background: #DCE6F2;">
                                    <th class="col-12">퇴소 높은 반 정보</th>
                                </tr>
                                <tr class="row" style="background:#DCE6F2;">
                                    <th class="col-1">순위</th>
                                    <th class="col-2">반 이름</th>
                                    <th class="col-2">학기</th>
                                    <th class="col-2">담임 T</th>
                                    <th class="col-2">이반 발생</th>
                                    <th class="col-1">퇴소 발생</th>
                                </tr>
                                <tr id="static_data1" class="row"></tr>
                            </table>
                            <table class="table text-center" style="width:100%;">
                                <tr class="row" style="background: #DCE6F2;">
                                    <th class="col-6">새로운 이반 승인 요청</th>
                                    <th class="col-6">새로운 퇴소 승인 요청</th>
                                </tr>
                                <tr class="row" style="background:#DCE6F2;">
                                    <th class="col-2">총 요청</th>
                                    <th class="col-2">응답한 요청</th>
                                    <th class="col-2">응답하지 않은 요청</th>
                                    <th class="col-2">총 요청</th>
                                    <th class="col-2">응답한 요청</th>
                                    <th class="col-2">응답하지 않은 요청</th>
                                </tr>
                                <tr id="newso" class="row"></tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="info-container mt-5">
            <div class="info-title">
                <span class="make_row">
                    이반 / 퇴소 요청 응답
                    <select id="question_view" class="form-select text-center w-25" name="question_view" onchange="so_paginating(this.value)">
                        <option value=0 selected>미응답 문의</option>
                        <option value=1>응답한 문의</option>
                    </select>
                </span>
            </div>
            <div class="info">
                <div class="d-flex justify-content-center align-items-center flex-column w-100">
                    <table class="table text-center" id="so_question" style="width:100%;">
                        <thead>
                            <tr class="row">
                                <th class="col-2">종류</th>
                                <th class="col-4">제목</th>
                                <th class="col-4">내용</th>
                                <th class="col-2">응답</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="so_tr" class="row"></tr>
                        </tbody>
                    </table>
                    <h3 id="no_data_msg"></h3>
                    <div id="so_pagination" class="py-2 text-center"></div>
                </div>
            </div>
        </div>
    
    </div>
    <!-- 학습 관리 -->
    <div class="info-container" id="ulbox" style="display: none;">
        <div class="info-title">
            <span>미학습 이력</span>
        </div>
        <div class="info">
            <div class="d-flex justify-content-center align-items-center flex-column w-100">
                <div class="d-flex justify-content-start align-items-start w-100" style="overflow: scroll;">
                    <div class="d-flex justify-content-center align-items-center flex-column"
                        style="width: 1362px important;">
                        <h3 id="ultitle"></h3>
                        <table class="table text-center" style="width:100%;" id="ul_data_box">
                            <tr class="row" style="background: #DCE6F2;">
                                <th class="col-12" id="displayCount2"></th>
                            </tr>
                            <tr class="row" style="background:#DCE6F2;">
                                <th class="col-1">순위</th>
                                <th class="col-2">학생</th>
                                <th class="col-2">미학습</th>
                                <th class="col-2">반 이름</th>
                                <th class="col-2">연락처</th>
                                <th class="col-2">추천도서코드</th>
                                <th class="col-1">상담이력</th>
                            </tr>
                            <tr id="static_data2" class="row"></tr>
                        </table>
                        <div id="ul_pagination"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 문의 관리 -->
    <div class="info-container" id="qubox" style="display: none;">
        <div class="info-title">
            <span class="make_row">
                선생님 문의 관리
                <select id="question_view" class="form-select text-center w-25" name="question_view"
                onchange="paginating(this.value)">
                <option value=0 selected>미응답 문의</option>
                <option value=1>응답한 문의</option>
            </select>
            </span>
        </div>
        <div class="info">
            <div class="d-flex justify-content-center align-items-center flex-column w-100">
                <table class="table text-center" id="teacher_question" style="width:100%;">
                    <thead>
                        <tr class="row">
                            <th class="col-2">종류</th>
                            <th class="col-4">제목</th>
                            <th class="col-4">내용</th>
                            <th class="col-2">응답</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="alim-tr" class="row"></tr>
                    </tbody>
                </table>
                <div id="pagination" class="py-2 text-center"></div>
            </div>
        </div>
    </div>

</div>

{% block jspart %}
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script type="text/javascript" src="../static/js/manage.js"></script>
{% endblock %}

{% endautoescape %}
{% endblock %}
