{% extends 'index.html' %}
{% block title %}
ì„ ìƒë‹˜ ì—…ë¬´ ê´€ë¦¬ í˜ì´ì§€
{% endblock %}

{% block topnav %}
{% if user %}
{{ user['name'] }} ({{ user['engname'] }})ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.
{% else %}
ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
{% endif %}
{% endblock %}
{% block style %}
<link rel="stylesheet" href="../static/style/teacher.css">
{% endblock %}
{% with messages = get_flashed_messages() %}
    {% if messages %}
    <script> alert("{{ messages[-1] }}")</script>
    {% endif %}
{% endwith %}
{% block content %}
{% autoescape off %}
<script type="text/javascript">
    var csrf_token = "{{ csrf_token() }}";

    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrf_token);
            }
        }
    });
</script>
<script type="text/javascript">
    axios.defaults.headers.common["X-CSRFToken"] = "{{ csrf_token() }}";
</script>
<!-- ë¬¸ì˜ ë‚¨ê¸°ê¸° -->
<div class="modal fade" id="question" tabindex="-1"
    aria-labelledby="questionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="questionModalLabel">
                    <img src="https://purpleacademy.net/free_project/public/image/head-office-question-btn.png" style="width: 30px;">&nbsp;&nbsp;ë³¸ì›ì— ë¬¸ì˜ ë‚¨ê¸°ê¸°
                </h5>
                <button type="button" class="btn btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body py-4 px-5">
                <form action="/teacher/question" method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" style="display: block;"/>
                    <div class="modal-body-select-container">
                        <span class="modal-body-select-label">ë¬¸ì˜ ì¢…ë¥˜</span>
                        <select id="question_kind" class="modal-body-select" name="question_category" onchange="change_question_kind(this.value)">
                            <option value="none" selected>ë¬¸ì˜ ì¢…ë¥˜ë¥¼ ì„ í•´ì£¼ì„¸ìš”</option>
                            <option value="ì¼ë°˜">ì¼ë°˜ ë¬¸ì˜</option>
                            <option value="ì´ë°˜">ì´ë°˜ ìŠ¹ì¸ ìš”ì²­</option>
                            <option value="í‡´ì†Œ">í‡´ì†Œ ìŠ¹ì¸ ìš”ì²­</option>
                            <option value="ì·¨ì†Œ/í™˜ë¶ˆ">ì·¨ì†Œ/í™˜ë¶ˆ ìŠ¹ì¸ ìš”ì²­</option>
                        </select>
                    </div>
                    <!-- invisible_for_2 start -->
                    <div id="invisible_for_2">
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ê¸°ì¡´ ë°˜</span> 
                            <select class="modal-body-select" name="ban_id">        
                                <option value="none" selected>ê¸°ì¡´ ë°˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                {% for ban in my_bans %}
                                    {% set ban_registerno = ban['register_no'] %}
                                    <option value={{ban_registerno}}>{{ban['name']}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ëŒ€ìƒ ì›ìƒ</span>
                            <select id="student_list" class="modal-body-select" name="target_student">
                                    <option value="none" selected>ì›ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                    {% for student in students %}
                                        {% set student_registerno = student['register_no'] %}
                                        <option value={{student_registerno}}>{{ student['name'] }}({{ student['origin']}})</option>
                                    {% endfor %}
                                    
                            </select>
                        </div>
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ìƒë‹´ ë‚´ìš©</span>
                            <select class="modal-body-select" name="consulting_history">
                                <option value="none" selected>ìƒë‹´ì„ ìš°ì„  ì§„í–‰í•´ì£¼ì„¸ìš”</option>
                                <option value=0>for student</option>
                            </select>
                        </div>
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ì´ë°˜ ìš”ì²­ ë°˜</span> 
                            <select class="modal-body-select" name="new_ban_id">    
                                <option value="none" selected>ì´ë°˜ í•˜ë ¤ëŠ” ë°˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                {% for ban in all_ban %}
                                    {% set ban_registerno = ban['register_no'] %}
                                    <option value={{ban_registerno}}>{{ ban['name'] }} ({{ ban['semester'] }}í•™ê¸°)</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <!-- invisible_for_2 end -->
                    <!-- invisible_for_1 start -->
                    <div id="invisible_for_1">
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ë°˜</span>
                            <select class="modal-body-select" name="o_ban_id">
                                <option value="none" selected>í‡´ì†Œí•˜ë ¤ëŠ” ë°˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                {% for ban in my_bans %}
                                    {% set ban_registerno = ban['register_no'] %}
                                    <option value={{ban_registerno}}>{{ ban['name'] }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ëŒ€ìƒ ì›ìƒ</span>
                            <select id="student_list" class="modal-body-select" name="o_target_student">
                                <option value="none" selected>ì›ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                {% for student in students %}
                                    {% set student_registerno = student['register_no'] %}
                                    <option value={{student.register_no}}>{{ student['name'] }}({{ student['origin'] }})</option>
                                {% endfor %}                
                            </select>
                        </div>    
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ìƒë‹´ ë‚´ìš©</span> 
                            <select class="modal-body-select" name="o_consulting_history">
                                <option value="none" selected>ì§„í–‰í•œ ìƒë‹´ì˜ ìƒë‹´ì¼ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                <option value=0>for student</option>
                            </select>
                        </div>
                    </div>
                    <!-- invisible_for_1 end -->
                    <div id="question_box">
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ë¬¸ì˜ ì œëª©</span>
                            <input class="modal-body-select" type="text" size="50" name="question_title" style="width: 75%;">
                        </div>
                        <div class="modal-body-select-container">
                            <span class="modal-body-select-label">ë¬¸ì˜ ë‚´ìš©</span>
                            <textarea id="question_contents" class="modal-body-select" type="text"rows="5" cols="25" name="question_contents" style="width: 75%;"></textarea>
                        </div>
                    </div>
                    <div class="d-flex justify-content-center mt-4 mb-2">
                        <button class="btn btn-dark" type="submit">ì €ì¥</button>

                        <!-- <button type="button" class="btn btn-danger" data-bs-dismiss="modal" style="margin-top: 13px;">ì·¨ì†Œ</button> -->
                    </div>
                </form>
            </div>           
        </div>
    </div>
</div>
<!-- ë¬¸ì˜ ì¡°íšŒ -->
<div class="modal fade" id="question_list" tabindex="-1"
    aria-labelledby="questionListModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="questionListModalLabel">
                    <img src="https://purpleacademy.net/free_project/public/image/answer-a-question.png" style="width: 30px; margin-bottom: 2px;">&nbsp;&nbsp;ë¬¸ì˜ ë‹µë³€ í™•ì¸ 
                </h5>
                <button type="button" class="btn btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body by-4 px-5">
                <div id="questiondetail" style="width:100%;">
                    <button type="button" class="btn btn-back" onclick="go_back()">ë‹¤ë¥¸ ë¬¸ì˜ì¡°íšŒğŸ”™ </button>
                    <div id="questiondetail_box" style="width:100%;"></div>
                </div>
                <table class="table text-center" id="questionlist" style="width:100%;">
                    <tbody  style="width:100%;">
                        <tr class="row">
                            <th class="col-3">ì¢…ë¥˜</th>
                            <th class="col-5">ì œëª©</th>
                            <th class="col-2">ë‹µë³€</th>
                            <th class="col-2">ìˆ˜ì •/ì‚­ì œ</th>
                        </tr>
                        {% if questions is iterable %}
                            {% for question in questions %}
                            <tr class="row">
                                {% if question.category == 0 %}
                                <td class="col-3">ì¼ë°˜ë¬¸ì˜</td>
                                {% elif question.category == 1 %}
                                <td class="col-3">í‡´ì†Œë¬¸ì˜</td>
                                {% elif question.category == 2 %}
                                <td class="col-3">ì´ë°˜ë¬¸ì˜</td>
                                {% else %}
                                <td class="col-3">ì·¨ì†Œ/í™˜ë¶ˆ</td>
                                {% endif %}
                                <td class="col-5">{{ question.title }} </td>
                                {% if question.answer_id == None %}
                                <td class="col-2"> ë¯¸ì‘ë‹µ </td>
                                {% else %}
                                <td class="col-2"  onclick="get_answer('{{question.id}}')">  âœ”ï¸  </td>
                                {% endif %}
                                <td class="col-2"  onclick="get_answer('{{question.id}}')"> âœï¸âŒ </td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr class="row">
                                {% if questions.category == 0 %}
                                <td class="col-3">ì¼ë°˜ë¬¸ì˜</td>
                                {% elif questions.category == 1 %}
                                <td class="col-3">í‡´ì†Œë¬¸ì˜</td>
                                {% elif questions.category == 2 %}
                                <td class="col-3">ì´ë°˜ë¬¸ì˜</td>
                                {% else %}
                                <td class="col-3">ì·¨ì†Œ/í™˜ë¶ˆ</td>
                                {% endif %}
                                <td class="col-7">{{ questions.title }} </td>
                                {% if questions.answer_id == null %}
                                <td class="col-2"> ë¯¸ë‹µë³€ </td>
                                {% else %}
                                <td class="col-2"  onclick="get_answer('{{questions.id}}')"> âœ”ï¸ </td>
                                {% endif %}
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>    
        </div>
    </div>
</div>

<div class="container_box">
    <div id="user-info" class="border-bottom">
        <div class="d-flex justify-content-center flex-row row-cols-2">
            <div class="p-5">
                <div class="d-flex justify-content-between flex-row row-cols-3">
                    <!-- <button onclick="edit_personal_info()">ì •ë³´ ìˆ˜ì •</button> -->
                    <div class="question-btn-container">
                        <div class="question-btn head-office-question-btn" data-bs-toggle="modal" data-bs-target="#question">
                            <img src="https://purpleacademy.net/free_project/public/image/head-office-question-btn.png">
                        </div>  
                        <span class="question-label">ë³¸ì› ë¬¸ì˜</span>
                    </div>
                    <div class="question-btn-container">
                        <div class="question-btn answer-a-question" data-bs-toggle="modal" data-bs-target="#question_list">
                            <img src="https://purpleacademy.net/free_project/public/image/answer-a-question.png">
                        </div>
                        <span class="question-label">ë¬¸ì˜ ë‹µë³€</span>
                    </div>
                    <div class="question-btn-container">
                        <div class="question-btn show-last-counsulting">
                            <img src="https://purpleacademy.net/free_project/public/image/show-last-counsulting.png">                        
                        </div>
                        <span class="question-label">ì§€ë‚œ ìƒë‹´ ì¡°íšŒ</span>
                    </div>                
                </div>
            </div> 
            <div class="d-flex justify-content-start align-items-center p-5">
                <div class="user-detail">
                    <div class="user-detail-deco"></div>
                    <div class="user-name">
                        <img src="https://purpleacademy.net/free_project/public/image/teacher-profile.png">
                        <span>{{ user['name'] }}({{ user['engname'] }}) ì„ ìƒë‹˜ ì•ˆë…•í•˜ì„¸ìš”.</span>
                    </div>
                    <div class="user-contact">
                        <div class="mt-2">
                           <i class="fa-regular fa-envelope"></i>                            
                           <span>&nbsp;&nbsp;{{ user['email'] }}</span>
                        </div>
                        <div class="mt-3">
                            <i class="fa-solid fa-mobile-screen-button"></i>
                            <span>&nbsp;&nbsp;{{ user['mobileno'] }}</span>
                        </div>
                    </div>
                </div>
            </div>            
        </div>
    </div>
    <div class="d-flex justify-content-center row-cols-2 ">
        <div id="statistics" class="p-5">
            <div class="info-container">
                <div class="info-title">
                    <span>Total Chart</span>
                </div>
                <div class="info">
                    <div class="total_chart">
                        <div class="chartWrap">
                            <div class="chart">
                                <div class="chart-total">
                                    <span class="chart-total-num">Total:<br></span>
                                </div>
                            </div>
                            <div class="chart-bar" data-deg="50"></div>
                                <div class="chart-bar" data-deg="95"></div>
                                <div class="chart-bar" data-deg="150"></div>
                                <div class="chart-bar" data-deg="295/360*100">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-container mt-5">
                <div class="info-title">
                    <span>Total Report</span>
                </div>
                <div class="info">
                    <div class="total_table">
                        <table class="table text-center" id="unlearned">
                            <tbody  style="width:100%;">
                                <tr class="row">
                                    <th class="col-3">IXL</th>
                                    <th class="col-3">ë¦¬ë”©</th>
                                    <th class="col-3">ë¦¬íŠ¹</th>
                                    <th class="col-3">ë¼ì´íŒ…</th>
                                </tr>
                                <tr class="row">
                                    <td class="col-3"> ì„ì‹œ3 (5%) </td>
                                    <td class="col-3"> ì„ì‹œ3 (5%) </td>
                                    <td class="col-3"> ì„ì‹œ3 (5%) </td>
                                    <td class="col-3"> ì„ì‹œ3 (5%) </td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table text-center" id="unlearned">
                            <tbody  style="width:100%;">
                                <tr class="row">
                                    <th class="col-6">ì—…ë¬´</th>
                                    <th class="col-6">ìƒë‹´</th>
                                </tr>
                                <tr class="row">
                                    <td class="col-3"> ì„ì‹œ3/10 </td>
                                    <td class="col-3"> 5% </td>
                                    <td class="col-3"> ì„ì‹œ3/10 </td>
                                    <td class="col-3"> 5% </td>
                                </tr>
                            </tbody>
                        </table>  
                        <table class="table text-center" id="unlearned">
                            <tbody  style="width:100%;">
                                <tr class="row">
                                    <th class="col-6">ê³µì§€</th>
                                    <th class="col-6">ë¬¸ì˜</th>
                                </tr>
                                <tr class="row">
                                    <td class="col-3"> ì„ì‹œ3/10 </td>
                                    <td class="col-3"> 5% </td>
                                    <td class="col-3"> ì„ì‹œ3/10 </td>
                                    <td class="col-3"> 5% </td>
                                </tr>
                            </tbody>
                        </table>      
                    </div>
                </div>
            </div>
        

            <div class="info-container mt-5">
                <div class="info-title">
                    <span>Class Report</span>
                </div>
                <div class="info">
                    <table class="table text-center" id="class_list" style="width:100%;">
                        <tbody  style="width:100%;">
                            <tr class="row">
                                <th class="col-2">ë°˜ì´ë¦„</th>
                                <th class="col-1">í•™ê¸°</th>
                                <th class="col-1">ì›ìƒ ìˆ˜</th>
                                <th class="col-2">í‡´ì†Œ</th>
                                <th class="col-2">ì´ë°˜</th>
                                <th class="col-2">ë¯¸í•™ìŠµ</th>
                                <th class="col-2">ë¬¸ì˜ ë¯¸ì‘ë‹µ</th>
                            </tr>
                            {% for ban in my_bans %}
                                <tr class="row">
                                    <td class="col-2">{{ ban['name'] }}</td>
                                    <td class="col-1">{{ ban['name_numeric'] }}</td>
                                    <td class="col-1">{{ ban['total_student_num '] }}</td>
                                    <td class="col-2"> ì„ì‹œ3 (5%) </td>
                                    <td class="col-2"> ì„ì‹œ3 (5%) </td>
                                    <td class="col-2"> ì„ì‹œ3 (5%) </td>
                                    <td class="col-2"> ì„ì‹œ3 (5%) </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>    
                </div>
            </div>
        </div>
    

    <div id="work" class="p-5">
        <div class="info-container">
            <div class="info-title">
                <span>To-Do List</span>
            </div>
            <div class="info d-flex justify-content-center align-items-center flex-column">
                <div class="d-flex justify-content-between flex-row w-100 pb-4 border-bottom">
                    <h5 class="d-flex justify-content-center align-items-center m-0" id="task_title">ì˜¤ëŠ˜ì˜ ì—…ë¬´</h3>
                    <select id="work_done" class="form-select text-center w-25" name="work_done" onchange="task_doneview(this.value)">
                        <option value=0 selected>ì˜¤ëŠ˜ì˜ ì—…ë¬´</option>
                        <option value=1>ì™„ë£Œí•œ ì—…ë¬´</option> 
                    </select>
                </div>
                <div class="w-100 mt-4" id="today_task_box">
                    {% for category in my_task_category %}
                        <details>
                            <summary onclick="get_task('{{category}}')"><strong>{{ all_task_category[category-1].name }} ì—…ë¬´ </strong></summary>
                            <div class="make_col" id="task_contents_box{{category}}"></div>
                        </details>
                    {% endfor %}
                    <button onclick="get_task_done()">ì—…ë¬´ ì™„ë£Œ ì €ì¥</button>
                </div>
                <div class="w-100 mt-4" id="today_done_box">
                </div>
            </div>
        </div>
    </div>

    <div id="consulting" class="p-5">
        <div class="info-container">
            <div class="info-title">
                <span>To-Do Manage</span>
            </div>
            <div class="info d-flex justify-content-center align-items-center flex-column">
                <div class="d-flex justify-content-between flex-row w-100 pb-4 border-bottom">
                    <h5 class="d-flex justify-content-center align-items-center m-0" id="task_title">ì˜¤ëŠ˜ì˜ ì—…ë¬´</h3>
                    <select id="work_done" class="form-select text-center w-25" name="work_done" onchange="consulting_view(this.value)">
                        <option value=0 selected>ì˜¤ëŠ˜ì˜ ìƒë‹´</option>
                        <option value=1>ì™„ë£Œí•œ ìƒë‹´</option> 
                    </select>
                </div>
                <div class="w-100 mt-4" id="today_consulting_box">
                    <p>consulting needed</p>
                </div>
                <div class="w-100 mt-4" id="today_done_consulting_box">
                </div>
            </div>
        </div>
    </div>

{% block jspart %}
<script type="text/javascript" src="../static/js/teacher.js"></script>
<script type="text/javascript" src="../static/js/chart.js"></script>
{% endblock %}

{% endautoescape %}
{% endblock %}
